---
title: "practice_1"
output: pdf_document
---

```{r}
#Problem 1

#Importing Libraries
library(data.table)

#Importing Data
cust_data <- read.csv('customertxndata.csv')
setDT(cust_data)

#Total Revenue
cust_data[,na.exclude(sum(revenue))]

#Mean Visits
cust_data[,na.exclude(mean(visits))]

#Mean Revenue
cust_data[,na.exclude(mean(revenue))]

#Median Revenue
cust_data[,na.exclude(median(revenue))]

#Most Common Gender
gender_count <- cust_data[,.(count = .N), by = "gender"]
gender_count
gender_count[,na.exclude(max(count))]

```


```{r}
#Problem 2
library("ggplot2")

#Total revenue by gender
revenue_by_gender <- cust_data[, sum(revenue), by = gender]
revenue_by_gender <- na.omit(revenue_by_gender)

#Bar chart 
ggplot(data=revenue_by_gender, aes(x=gender, y=V1)) +
  geom_bar(stat="identity", fill="steelblue", width = 0.5) +
  xlab("Gender") + ylab("Revenue")
```


```{r}
#Problem 3
library("ggpubr")

#Pearson Moment of Correlation between number of visits and revenue
ggscatter(cust_data, x = "visits", y = "revenue", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "Number of visits", ylab = "Revenue generated") +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = "cs"))
```


```{r}
#Problem 4
library(tidyverse)

#creating a table containing only the NA values
na_data <- cust_data %>% filter_all(any_vars(is.na(.)))

```


```{r}
#Problem 5

#Mean transactions
clean_cust_data <- na.omit(cust_data)
clean_cust_data[, round(mean(transactions))]

#Assigning mean value to NA in transactions column
impute_trans <- cust_data
impute_trans[is.na(cust_data$transactions)] <- 1

#Creating function for mode
getmode <- function(v) 
  {
   uniqv <- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
  }

#Mode of gender
cust_data[, getmode(gender)]

#Assigning mode value to NA in gender column
impute_gender <- cust_data
impute_gender[is.na(cust_data$gender)] <- "Male"
```


```{r}
#Problem 6

#Spliting the data into a trainig and validation dataset 
training_data <- cust_data[rep(c(TRUE,FALSE), length = .N), ]     #logical vector c(TRUE,FALSE) will only return 1st,3rd,5th...values
validation_data <- cust_data[rep(c(FALSE,TRUE), length = .N), ]   #logical vector c(FALSE,TRUE) will only return 2nd,4th,6th...values
```


```{r}
#Problem 7

#Calculating mean revenue for trainig dataset
training_data[,na.exclude(mean(revenue))]

#Calculating mean revenue for validation dataset
validation_data[,na.exclude(mean(revenue))]
```


```{r}
#Problem 8
set.seed(77654)

#Creating first sample to set 60% of data for training
sample_1 <- sample.int(n = nrow(cust_data), size = floor(.60*nrow(cust_data)), replace = F)

#Creating dataset for training
training <- cust_data[sample_1,]

#Creating a dataset of the remaining data for testing and validation
remaining_data <- cust_data[-sample_1,]

#Creating second sample to split the reamining dataset for testing and validation
sample_2 <- sample.int(n = nrow(remaining_data), size = floor(.50*nrow(remaining_data)), replace = F)

#Creating dataset for testing
testing <- remaining_data[sample_2, ]

#Creating dataset for validation
validation <- remaining_data[-sample_2, ]
```

